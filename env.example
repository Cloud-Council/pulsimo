# ==============================================================================
# PULSIMO MONITORING SYSTEM - ENVIRONMENT CONFIGURATION
# ==============================================================================
# Copy this file to .env and configure for your environment
# 
# IMPORTANT: Change all passwords and secrets before deploying to production!
# ==============================================================================

# ------------------------------------------------------------------------------
# HOST CONFIGURATION
# ------------------------------------------------------------------------------
# Your server/VM IP address or domain name
# This is where your Pulsimo instance will be accessible
# Examples: 
#   - 192.168.1.100 (local network)
#   - monitoring.yourcompany.com (domain)
#   - localhost (local development only)
HOST_IP=localhost

# Alternative: If using domain name instead of IP
# HOST_DOMAIN=monitoring.yourcompany.com

# ------------------------------------------------------------------------------
# DATABASE CONFIGURATION (PostgreSQL)
# ------------------------------------------------------------------------------
POSTGRES_DB=monitoring_system
POSTGRES_USER=monitoring
POSTGRES_PASSWORD=ChangeThisPassword123!

# Database connection URL (automatically constructed from above)
# For Docker: use container name 'postgres'
# For local dev: use 'localhost'
DATABASE_URL=postgresql://${POSTGRES_USER}:${POSTGRES_PASSWORD}@postgres:5432/${POSTGRES_DB}

# Database Port (default 5432)
POSTGRES_PORT=5432

# ------------------------------------------------------------------------------
# REDIS CONFIGURATION
# ------------------------------------------------------------------------------
# Redis connection URL
# For Docker: use container name 'redis'
# For local dev: use 'localhost'
REDIS_URL=redis://redis:6379

# Redis Port (default 6379)
REDIS_PORT=6379

# ------------------------------------------------------------------------------
# JWT AUTHENTICATION
# ------------------------------------------------------------------------------
# CRITICAL: Change this to a strong random secret in production!
# Generate with: openssl rand -base64 32
JWT_SECRET=CHANGE_THIS_TO_RANDOM_SECRET_IN_PRODUCTION_USE_OPENSSL_RAND

# ------------------------------------------------------------------------------
# SMTP EMAIL CONFIGURATION (for email notifications)
# ------------------------------------------------------------------------------
# Email provider SMTP settings
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587

# SMTP Authentication
SMTP_USERNAME=your-email@gmail.com
SMTP_PASSWORD=your-app-specific-password

# Email sender information
FROM_EMAIL=noreply@yourdomain.com
FROM_NAME=Pulsimo Monitoring

# SMTP Usage Notes:
# - Gmail: Use App Password (not account password)
#   https://support.google.com/accounts/answer/185833
# - AWS SES: smtp.eu-west-1.amazonaws.com (port 587)
# - SendGrid: smtp.sendgrid.net (port 587, username: apikey)
# - Mailgun: smtp.mailgun.org (port 587)

# ------------------------------------------------------------------------------
# API GATEWAY CONFIGURATION
# ------------------------------------------------------------------------------
# API Gateway host and port
API_HOST=0.0.0.0
API_PORT=8080

# Logging level (trace, debug, info, warn, error)
API_LOG_LEVEL=info

# ------------------------------------------------------------------------------
# CHECKER SERVICE CONFIGURATION
# ------------------------------------------------------------------------------
# How often to run health checks (in seconds)
CHECK_INTERVAL_SECONDS=30

# Maximum concurrent health checks
MAX_CONCURRENT_CHECKS=100

# Health check timeout (seconds)
CHECK_TIMEOUT_SECONDS=30

# Logging level
CHECKER_LOG_LEVEL=info

# ------------------------------------------------------------------------------
# NOTIFICATION SERVICE CONFIGURATION
# ------------------------------------------------------------------------------
# Logging level
NOTIFICATION_LOG_LEVEL=info

# ------------------------------------------------------------------------------
# DEPENDENCY TRACKER CONFIGURATION
# ------------------------------------------------------------------------------
# How often to run dependency discovery (in seconds)
DISCOVERY_INTERVAL_SECONDS=300

# How often to calculate dependency impact (in seconds)
IMPACT_CALCULATION_INTERVAL_SECONDS=600

# Service port
DEPENDENCY_TRACKER_PORT=8083

# Logging level
DEPENDENCY_LOG_LEVEL=info

# ------------------------------------------------------------------------------
# MAINTENANCE SCHEDULER CONFIGURATION
# ------------------------------------------------------------------------------
# Timezone for scheduled jobs (e.g., UTC, America/New_York, Europe/London)
TZ=UTC

# Service port
MAINTENANCE_PORT=3007

# ------------------------------------------------------------------------------
# FRONTEND CONFIGURATION
# ------------------------------------------------------------------------------
# IMPORTANT: Frontend now uses RUNTIME configuration!
# You have two options to configure frontend URLs:
#
# OPTION 1 (RECOMMENDED): Just set HOST_IP, URLs are auto-constructed
# - Set HOST_IP above (e.g., 192.168.1.100)
# - Leave NEXT_PUBLIC_API_URL and NEXT_PUBLIC_WS_URL commented/empty
# - Frontend automatically uses: http://HOST_IP:8080 and ws://HOST_IP:8080
#
# OPTION 2: Explicitly set URLs (overrides HOST_IP)
# - Uncomment and set NEXT_PUBLIC_API_URL and NEXT_PUBLIC_WS_URL below
# - Use this for custom ports or domains
#
# Choose ONE option - Option 1 is simpler for most deployments

# Option 1: Just set HOST_IP above (recommended)
# Frontend will auto-construct: http://HOST_IP:8080 and ws://HOST_IP:8080

# Option 2: Explicit URLs (uncomment if needed)
NEXT_PUBLIC_API_URL=http://monitoring.company.com:8080
NEXT_PUBLIC_WS_URL=ws://monitoring.company.com:8080

# Application version (used in runtime config)
APP_VERSION=v1beta1

# ------------------------------------------------------------------------------
# PORTS CONFIGURATION (for docker-compose port mapping)
# ------------------------------------------------------------------------------
# External ports (what users access)
# Change these if you have port conflicts

# PostgreSQL external port
EXPOSE_POSTGRES_PORT=5432

# Redis external port
EXPOSE_REDIS_PORT=6379

# API Gateway external port
EXPOSE_API_PORT=8080

# Frontend external port
EXPOSE_FRONTEND_PORT=3000

# ------------------------------------------------------------------------------
# SECURITY NOTES
# ------------------------------------------------------------------------------
# 1. Change all default passwords before production deployment
# 2. Use strong JWT_SECRET (generate with: openssl rand -base64 32)
# 3. Never commit .env file to version control
# 4. Restrict database ports if not needed externally
# 5. Use HTTPS/WSS in production (setup reverse proxy like nginx)
# 6. For Gmail SMTP, use App Passwords, not your account password
# 7. Consider using secrets management (Docker secrets, Vault, etc.)

# ------------------------------------------------------------------------------
# DEPLOYMENT CHECKLIST
# ------------------------------------------------------------------------------
# Essential (Must Do):
# [ ] Copy .env.example to .env
# [ ] Set HOST_IP to your server IP or domain (e.g., 192.168.1.100)
# [ ] Change POSTGRES_PASSWORD to a strong password
# [ ] Change JWT_SECRET to a random secret (use: openssl rand -base64 32)
#
# For Email Notifications (Recommended):
# [ ] Configure SMTP settings (SMTP_HOST, SMTP_PORT, SMTP_USERNAME, SMTP_PASSWORD)
# [ ] Update FROM_EMAIL and FROM_NAME
#
# Advanced (Optional):
# [ ] Review and adjust port mappings if you have conflicts
# [ ] Set explicit NEXT_PUBLIC_API_URL/WS_URL if needed (otherwise auto-constructed)
# [ ] Adjust CHECK_INTERVAL_SECONDS for different monitoring frequency
# [ ] Modify resource limits in docker-compose.prod.yml if needed
#
# Validation & Deployment:
# [ ] Test configuration: docker compose -f docker-compose.prod.yml config
# [ ] Deploy: ./setup-prod.sh (or: docker compose -f docker-compose.prod.yml up -d)
# [ ] Verify: Check logs and access http://HOST_IP:3000
#
# Post-Deployment:
# [ ] Login and create first organization
# [ ] Add first endpoint to monitor
# [ ] Test notifications if configured
# [ ] Verify WebSocket connection in browser console
# ==============================================================================
